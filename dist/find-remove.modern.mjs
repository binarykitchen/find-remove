import e from"fs";import t from"path";import{rimrafSync as n}from"rimraf";let i,o;function r(t,n){if(!i)return!1;const o=e.statSync(t).mtime.getTime();return i>o+1e3*n}function l(e={}){return void 0!==e.totalRemoved?e.totalRemoved:-2}function a(e={}){return l(e)>=function(e={}){return void 0!==e.limit?e.limit:-1}(e)}function s(e={}){return void 0!==e.maxLevel?e.maxLevel:-1}function c(e={}){return e.age&&e.age.seconds?e.age.seconds:null}const f=function f(d,m={},u){let v={};if(!a(m)&&e.existsSync(d)){const x=s(m);let y=!1;void 0!==m.limit&&(m.totalRemoved=void 0!==m.totalRemoved?l(m):0),void 0===u?u=0:u++,u<1?(i=(new Date).getTime(),o=m.test):y=function(e,n={},i){let o=!1;const l=n.dir;if(l){const f=c(n),d=t.basename(e);Array.isArray(l)?o=-1!==l.indexOf("*")||-1!==l.indexOf(d):(n.regex&&d.match(new RegExp(l))||d===l||"*"===l)&&(o=!0),o&&void 0!==n.limit&&(o=!a(n)),o&&void 0!==n.maxLevel&&i>0&&(o=i<=s(n)),f&&o&&(o=r(e,f))}return o}(d,m,u),(-1===x||u<x)&&e.readdirSync(d).forEach(function(n){var i;const l=t.join(d,n);let s,x=!1;try{s=e.statSync(l)}catch(e){x=!0}if(x);else if(null!=(i=s)&&i.isDirectory()){const e=f(l,m,u);v=Object.assign({},v,e),void 0!==m.totalRemoved&&(m.totalRemoved+=Object.keys(e).length)}else if(function(e,n={}){let i=!1;const o=n.extensions?n.extensions:null,l=n.files?n.files:null,s=n.prefix?n.prefix:null,f=n&&n.ignore?n.ignore:null,d=t.basename(e);if(l&&(i=Array.isArray(l)?-1!==l.indexOf("*.*")||-1!==l.indexOf(d):!!(n.regex&&d.match(new RegExp(l))||"*.*"===l)||d===l),!i&&o){const n=t.extname(e);i=Array.isArray(o)?-1!==o.indexOf(n):n===o}if(!i&&s&&(i=0===d.indexOf(s)),i&&void 0!==n.limit&&(i=!a(n)),i&&f&&(i=Array.isArray(f)?!(-1!==f.indexOf(d)):!(d===f)),i){const t=c(n);t&&(i=r(e,t))}return i}(l,m)){let t;if(o)t=!0;else try{e.unlinkSync(l),t=!0}catch(e){}t&&(v[l]=!0,void 0!==m.totalRemoved&&m.totalRemoved++)}}),y&&(o||n(d),void 0===m.totalRemoved&&(v[d]=!0))}return v};export{f as default};
//# sourceMappingURL=find-remove.modern.mjs.map
