import e from"fs";import i from"path";import{rimrafSync as t}from"rimraf";var r,n;function o(i,t){if(!r)return!1;var n=e.statSync(i).mtime.getTime();return r>n+1e3*t}function a(e){return void 0===e&&(e={}),void 0!==e.totalRemoved?e.totalRemoved:-2}function v(e){return void 0===e&&(e={}),a(e)>=function(e){return void 0===e&&(e={}),void 0!==e.limit?e.limit:-1}(e)}function d(e){return void 0===e&&(e={}),void 0!==e.maxLevel?e.maxLevel:-1}function f(e){return void 0===e&&(e={}),e.age&&e.age.seconds?e.age.seconds:null}var l=function(m,s,u){void 0===s&&(s={});var c={};if(!v(s)&&e.existsSync(m)){var x=d(s),y=!1;void 0!==s.limit&&(s.totalRemoved=void 0!==s.totalRemoved?a(s):0),void 0===u?u=0:u++,u<1?(r=(new Date).getTime(),n=s.test):y=function(e,t,r){void 0===t&&(t={});var n=!1,a=t.dir;if(a){var l=f(t),m=i.basename(e);Array.isArray(a)?n=-1!==a.indexOf("*")||-1!==a.indexOf(m):(t.regex&&m.match(new RegExp(a))||m===a||"*"===a)&&(n=!0),n&&void 0!==t.limit&&(n=!v(t)),n&&void 0!==t.maxLevel&&r>0&&(n=r<=d(t)),l&&n&&(n=o(e,l))}return n}(m,s,u),(-1===x||u<x)&&e.readdirSync(m).forEach(function(t){var r,a,d=i.join(m,t),x=!1;try{a=e.statSync(d)}catch(e){x=!0}if(x);else if(null!=(r=a)&&r.isDirectory()){var y=l(d,s,u);c=Object.assign({},c,y),void 0!==s.totalRemoved&&(s.totalRemoved+=Object.keys(y).length)}else if(function(e,t){void 0===t&&(t={});var r=!1,n=t.extensions?t.extensions:null,a=t.files?t.files:null,d=t.prefix?t.prefix:null,l=t&&t.ignore?t.ignore:null,m=i.basename(e);if(a&&(r=Array.isArray(a)?-1!==a.indexOf("*.*")||-1!==a.indexOf(m):!!(t.regex&&m.match(new RegExp(a))||"*.*"===a)||m===a),!r&&n){var s=i.extname(e);r=Array.isArray(n)?-1!==n.indexOf(s):s===n}if(!r&&d&&(r=0===m.indexOf(d)),r&&void 0!==t.limit&&(r=!v(t)),r&&l&&(r=Array.isArray(l)?!(-1!==l.indexOf(m)):!(m===l)),r){var u=f(t);u&&(r=o(e,u))}return r}(d,s)){var g;if(n)g=!0;else try{e.unlinkSync(d),g=!0}catch(e){}g&&(c[d]=!0,void 0!==s.totalRemoved&&s.totalRemoved++)}}),y&&(n||t(m),void 0===s.totalRemoved&&(c[m]=!0))}return c};export{l as default};
//# sourceMappingURL=find-remove.mjs.map
